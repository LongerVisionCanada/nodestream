<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Home - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Nodestream.html">Nodestream</a><ul class='methods'><li data-type='method'><a href="Nodestream.html#addTransform">addTransform</a></li><li data-type='method'><a href="Nodestream.html#download">download</a></li><li data-type='method'><a href="Nodestream.html#remove">remove</a></li><li data-type='method'><a href="Nodestream.html#upload">upload</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#isInstalled">isInstalled</a></li></ul>
</nav>

<div id="main">
    

    



    









    


    <section class="readme">
        <article><h1>Nodestream</h1><p><a href="https://npmjs.org/package/nodestream"><img src="https://badge.fury.io/js/nodestream.svg" alt="NPM Version"></a>
<a href="https://travis-ci.org/nodestream/nodestream"><img src="https://travis-ci.org/nodestream/nodestream.svg" alt="Build Status"></a>
<a href="https://coveralls.io/r/nodestream/nodestream"><img src="https://img.shields.io/coveralls/nodestream/nodestream.svg" alt="Coverage Status"></a>
<a href="http://inch-ci.org/github/nodestream/nodestream"><img src="http://inch-ci.org/github/nodestream/nodestream.svg" alt="Documentation Status"></a>
<img src="https://img.shields.io/badge/built%20with-GNU%20Make-brightgreen.svg" alt="Built with GNU Make"></p>
<blockquote>
<p>Streaming library for binary data transfers</p>
</blockquote>
<h2>Description</h2><p>This library aims to provide an abstraction layer between your application/library and all the various remote storage services which exist on the market, either as hosted by 3rd parties or self-hosted (S3, GridFS etc.). Your code should not depend on these services directly - the code responsible for uploading a file should remain the same no matter which storage service you decide to use. The only thing that can change is the configuration.</p>
<h2>Adapters</h2><table>
<thead>
<tr>
<th style="text-align:center"><a href="https://github.com/nodestream/nodestream-s3"><img src="https://cloud.githubusercontent.com/assets/3058150/13901098/80692616-ee18-11e5-98c1-91c35b936c51.png" alt="S3"></a></th>
<th style="text-align:center"><a href="https://github.com/nodestream/nodestream-gridfs"><img src="https://cloud.githubusercontent.com/assets/3058150/13901696/59652146-ee2c-11e5-8c7e-3cba5ba9854c.png" alt="GridFS"></a></th>
<th style="text-align:center"><a href="https://github.com/nodestream/nodestream-filesystem"><img src="https://cloud.githubusercontent.com/assets/3058150/13901081/d81b824c-ee17-11e5-8fbe-40eff40646f7.png" alt="Filesystem"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Amazon S3</td>
<td style="text-align:center">GridFS (WIP)</td>
<td style="text-align:center">Local Filesystem</td>
</tr>
</tbody>
</table>
<h2>Usage</h2><h3>Installation</h3><p>The first step is to install nodestream into your project:</p>
<p><code>npm install --save nodestream</code></p>
<p>The next thing is to decide which <em>adapter</em> you want to use. An adapter is an interface for nodestream to be able to interact with a particular storage system. Let's use local filesystem for a start:</p>
<p><code>npm install --save nodestream-filesystem</code></p>
<h3>Configuration</h3><p>Let's create and configure a nodestream instance with which your application can then interact:</p>
<pre class="prettyprint source lang-js"><code>// Require the main Nodestream class
const Nodestream = require('nodestream')
const nodestream = new Nodestream({
  // This tells nodestream which storage system it should interact with
  // Under the hood, it will try to require `nodestream-filesystem` module
  adapter: 'filesystem',
  // This object is always specific to your adapter of choice - always check
  // the documentation for that adapter for available options
  config: {
    // You MUST provide either an absolute path or nothing at all
    // You can use array notation, the parts will be joined for you
    root: [__dirname, '.storage']
  }
})</code></pre><p>Great! At this point, nodestream is ready to transfer some bytes!</p>
<h3>Usage</h3><h4>Uploading</h4><p>You can upload any kind of readable stream. Nodestream does not care where that stream comes from, whether it's an http upload or a file from your filesystem or something totally different.</p>
<p>For this example, we will upload a file from our filesystem.</p>
<blockquote>
<p>We will be uploading the file to our local filesystem as well as reading it from the same filesystem. Normally you would probably use a source different from the target storage, but Nodestream does not really care.</p>
</blockquote>
<pre class="prettyprint source lang-js"><code>const fs = require('fs')
// This is the file we will upload - create a readable stream of that file
const profilePic = fs.createReadStream('/users/me/pictures/awesome-pic.png')

nodestream.upload(profilePic, {
  // directory and name are supported by all storage adapters, but each
  // adapter might have additional options you can use
  directory: 'avatars',
  name: 'user-123.png'
})
.then(results => {
  // results can contain several properties, but the most interesting
  // and always-present is `location` - you should definitely save this
  // somewhere, you will need it to retrieve this file later!
  console.log(results.location)
})
.catch(err => {
  // U-oh, something blew up ðŸ˜±
})</code></pre><p>Congratulations, you just uploaded your first file!</p>
<h4>Downloading</h4><p>Downloading a file is quite straight-forward - all you need is the file's location as returned by the <code>upload()</code> method. You will always get back a readable stream which you can then <code>.pipe()</code> to something. Again, Nodestream does not care where you are sending the bytes, be it local filesystem, an http response or even a different Nodestream instance (ie. S3 to GridFS transfer).</p>
<pre class="prettyprint source lang-js"><code>// We are hardcoding the location here, but you will probably want to
// retrieve the file's location from a database
const file = nodestream.download('avatars/user-123.png')

// Let's create a destination for the download
const fs = require('fs')
const destination = fs.createWriteStream('/users/me/downloads/picture.png')

// Since file is a readable stream, we can pipe it to any other writable
// stream we like
file.pipe(destination)
file.once('end', () => console.log('all bytes sent to destination!'))</code></pre><h4>Removing</h4><p>Just pass the file's location to the <code>.remove()</code> method.</p>
<pre class="prettyprint source lang-js"><code>nodestream.remove('avatars/user-123.png')
.then(location => {
  // The file at this location has just been removed!
})
.catch(err => {
  // Oh no!
})</code></pre><h3>Transforms</h3><p>Nodestream supports a feature called transforms. In principle, a transform is just a function that modifies the incoming or outgoing bytes in some way, transparently for each stream passing through Nodestream. Some use cases:</p>
<ul>
<li>Calculating checksums</li>
<li>Compressing/decompressing data</li>
<li>Modifying the data completely, ie. appending headers/footers and whatnot</li>
</ul>
<h4>Registering a transform</h4><p>When you configure your Nodestream instance, you should register transforms using the <code>.addTransform()</code> function.</p>
<pre class="prettyprint source lang-js"><code>// The first argument defines when the transform should be applied ('upload', 'download')
// The second argument is the transform's name - Nodestream will attempt to require
// `nodestream-transform-compress` under the hood, so make sure you have it installed!
// The third argument is an option configuration object which will be passed as-is to
// the transform stream when the time comes to use the transform.
nodestream.addTransform('upload', 'compress', { mode: 'compress' })
nodestream.addTransform('download', 'compress', { mode: 'decompress' })</code></pre><p>Now, every time you call <code>.upload()</code> or <code>.download()</code>, the respective transform will be applied on the stream.</p>
<p>For uploads, a transform can optionally publish some data about the applied transformations onto the <code>results</code> object.</p>
<p>There is no limit to the amount of transforms which can be registered per Nodestream instance.</p>
<h2>License</h2><p>This software is licensed under the <strong>BSD-3-Clause License</strong>. See the <a href="LICENSE">LICENSE</a> file for more information.</p></article>
    </section>






</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Sun Mar 20 2016 01:33:19 GMT+0100 (CET) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>